from pwn import *
import random

AES_SWAP_OPERATOR = 235

s_box = [
    0x63, 0x7C, 0x77, 0x7B, 0xF2, 0x6B, 0x6F, 0xC5, 0x30, 0x01, 0x67, 0x2B, 0xFE, 0xD7, 0xAB, 0x76,
    0xCA, 0x82, 0xC9, 0x7D, 0xFA, 0x59, 0x47, 0xF0, 0xAD, 0xD4, 0xA2, 0xAF, 0x9C, 0xA4, 0x72, 0xC0,
    0xB7, 0xFD, 0x93, 0x26, 0x36, 0x3F, 0xF7, 0xCC, 0x34, 0xA5, 0xE5, 0xF1, 0x71, 0xD8, 0x31, 0x15,
    0x04, 0xC7, 0x23, 0xC3, 0x18, 0x96, 0x05, 0x9A, 0x07, 0x12, 0x80, 0xE2, 0xEB, 0x27, 0xB2, 0x75,
    0x09, 0x83, 0x2C, 0x1A, 0x1B, 0x6E, 0x5A, 0xA0, 0x52, 0x3B, 0xD6, 0xB3, 0x29, 0xE3, 0x2F, 0x84,
    0x53, 0xD1, 0x00, 0xED, 0x20, 0xFC, 0xB1, 0x5B, 0x6A, 0xCB, 0xBE, 0x39, 0x4A, 0x4C, 0x58, 0xCF,
    0xD0, 0xEF, 0xAA, 0xFB, 0x43, 0x4D, 0x33, 0x85, 0x45, 0xF9, 0x02, 0x7F, 0x50, 0x3C, 0x9F, 0xA8,
    0x51, 0xA3, 0x40, 0x8F, 0x92, 0x9D, 0x38, 0xF5, 0xBC, 0xB6, 0xDA, 0x21, 0x10, 0xFF, 0xF3, 0xD2,
    0xCD, 0x0C, 0x13, 0xEC, 0x5F, 0x97, 0x44, 0x17, 0xC4, 0xA7, 0x7E, 0x3D, 0x64, 0x5D, 0x19, 0x73,
    0x60, 0x81, 0x4F, 0xDC, 0x22, 0x2A, 0x90, 0x88, 0x46, 0xEE, 0xB8, 0x14, 0xDE, 0x5E, 0x0B, 0xDB,
    0xE0, 0x32, 0x3A, 0x0A, 0x49, 0x06, 0x24, 0x5C, 0xC2, 0xD3, 0xAC, 0x62, 0x91, 0x95, 0xE4, 0x79,
    0xE7, 0xC8, 0x37, 0x6D, 0x8D, 0xD5, 0x4E, 0xA9, 0x6C, 0x56, 0xF4, 0xEA, 0x65, 0x7A, 0xAE, 0x08,
    0xBA, 0x78, 0x25, 0x2E, 0x1C, 0xA6, 0xB4, 0xC6, 0xE8, 0xDD, 0x74, 0x1F, 0x4B, 0xBD, 0x8B, 0x8A,
    0x70, 0x3E, 0xB5, 0x66, 0x48, 0x03, 0xF6, 0x0E, 0x61, 0x35, 0x57, 0xB9, 0x86, 0xC1, 0x1D, 0x9E,
    0xE1, 0xF8, 0x98, 0x11, 0x69, 0xD9, 0x8E, 0x94, 0x9B, 0x1E, 0x87, 0xE9, 0xCE, 0x55, 0x28, 0xDF,
    0x8C, 0xA1, 0x89, 0x0D, 0xBF, 0xE6, 0x42, 0x68, 0x41, 0x99, 0x2D, 0x0F, 0xB0, 0x54, 0xBB, 0x16,
]

tracked_operator = [(255, 112), (194, 221), (141, 154), (124, 161), (159, 104), (250, 47), (246, 119), (219, 249), (56, 176), (230, 41), (26, 72), (107, 26), 
(59, 115), (247, 4), (221, 78), (75, 16), (34, 253), (192, 176), (6, 37), (229, 144), (179, 160), (207, 155), (171, 136), (114, 20), (35, 143), (72, 134), (18, 55), (2, 129), (220, 214), (186, 102), (196, 123), (20, 66), (47, 26), (247, 148), (214, 208), (252, 105), (167, 156), (2, 151), (204, 170), (169, 67), (145, 159), (126, 135), (186, 3), (22, 67), (27, 43), (52, 65), (169, 53), (180, 201), (166, 124), (127, 
12), (129, 246), (158, 27), (222, 153), (229, 128), (159, 95), (89, 164), (252, 174), (241, 198), (56, 224), (170, 208), (147, 16), (0, 202), (86, 40), (235, 213), (220, 117), (127, 133), (224, 184), (226, 195), (58, 176), (6, 138), (97, 87), (8, 161), (49, 251), (9, 196), (62, 41), (114, 222), (169, 215), (152, 94), (168, 248), (115, 153), (47, 219), (110, 236), (43, 35), (64, 12), (87, 197), (248, 248), (129, 64), (3, 224), (217, 132), (64, 148), (221, 191), (115, 239), (151, 68), (86, 207), (141, 13), (76, 95), (207, 223), (66, 163), (122, 184), (7, 48), (88, 216), (65, 177), (65, 123), (89, 84), (89, 121), (116, 138), (202, 207), (42, 86), (147, 114), (182, 88), (159, 47), (92, 213), (218, 14), (246, 168), (253, 159), (30, 181), (201, 97), (102, 23), (219, 82), (69, 40), (181, 78), (227, 11), (247, 147), (231, 254), (138, 122), (244, 79), (243, 106), (168, 117), (41, 36), (41, 252), (202, 161), (198, 173), (190, 192), (9, 30), (91, 33), (218, 125), (129, 
209), (236, 239), (240, 208), (217, 237), (240, 198), (6, 251), (189, 44), (151, 175), (60, 129), (129, 62), (17, 246), (235, 213), (84, 243), (246, 35), (134, 189), (198, 8), (213, 174), (255, 178), (33, 116), (151, 48), (32, 81), (220, 156), (203, 216), (202, 89), (78, 219), 
(35, 35), (145, 26), (182, 5), (81, 125), (13, 156), (92, 229), (99, 200), (84, 100), (157, 198), (84, 242), (38, 48), (202, 153), (201, 163), (165, 230), (52, 215), (224, 147), (235, 16), (120, 93), (194, 146), (130, 86), (70, 134), (36, 230), (72, 189), (192, 3), (60, 9), (231, 124), (5, 31), (74, 30), (7, 145), (130, 194), (70, 158), (106, 241), (72, 242), (59, 0), (255, 169), (145, 206), (180, 12), (177, 0), (116, 212), (64, 14), (218, 205), (22, 101), (39, 172), (232, 24), (198, 205), (126, 31), (204, 39), (48, 111), (192, 84), (137, 154), (54, 
27), (155, 28), (192, 204), (71, 250), (205, 219), (183, 59), (206, 26), (247, 79), (212, 3), (235, 240), (137, 250), (97, 117), (184, 158), (34, 18), (136, 9), (115, 198), (20, 185), (220, 249), (169, 163), (182, 90), (8, 97), (76, 34), (60, 110), (107, 82)]

def main():
    host = '34.42.147.172'
    port = 8005
    t = remote(host, port)
    print("Starting brute force...")
    for cnt in range(1, AES_SWAP_OPERATOR+1):
        num1 = tracked_operator[cnt-1][0]
        num2 = tracked_operator[cnt-1][1]

        # Receive the prompt and print it
        cond = f"({cnt}) Bribe soldiers to swap their positions: "
        
        # Send the input after the prompt
        print(t.sendlineafter(cond.encode('utf-8'), f"{num1} {num2}".encode('utf-8')).decode('utf-8') + f"{num1} {num2}")
        s_box[num1], s_box[num2] = s_box[num2], s_box[num1]
        if cnt == 235:
            break
    print(s_box)
    t.interactive()
if __name__ == '__main__':
    main()
